"use strict";!function e(t,o,n){function i(a,s){if(!o[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(r)return r(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var l=o[a]={exports:{}};t[a][0].call(l.exports,function(e){var o=t[a][1][e];return i(o?o:e)},l,l.exports,e,t,o,n)}return o[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t,o){function n(){function e(){i.update(),r.render(a,s),c.update(),requestAnimationFrame(function(){e()})}var t=document.getElementById("r3d");r=new THREE.WebGLRenderer({antialias:!0}),r.setSize(t.offsetWidth,t.offsetHeight),r.setClearColor(16777215,1);var o=r.context.getParameter(r.context.MAX_TEXTURE_SIZE);window.console.log(o),t.appendChild(r.domElement),c=new Stats,t.appendChild(c.domElement),a=new THREE.Scene,s=new THREE.PerspectiveCamera(45,t.offsetWidth/t.offsetHeight,1,1e7),s.position.x=100,s.position.y=100,s.position.z=100,s.lookAt(a.position),i=new l(s,r.domElement),e()}var i,r,a,s,c,d=e("../../modules/geometries/geometries.slice"),l=e("../../modules/controls/OrbitControls2D");window.onload=function(){n();var e=new THREE.Vector3(123,45,67),t=new THREE.BoxGeometry(e.x,e.y,e.z),o=new THREE.MeshBasicMaterial({wireframe:!0,color:6419187}),i=new THREE.Mesh(t,o);a.add(i);var r=e.clone().divideScalar(2),s=new THREE.Vector3(0,0,0),c=new THREE.Vector3(new THREE.Vector3(1,0,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,0,1)),l=s.clone(),p=new THREE.Vector3(-.2,.5,.3),h=new d(r,s,c,l,p),E=new THREE.MeshBasicMaterial({side:THREE.DoubleSide,transparency:!0,color:240116}),u=new THREE.Mesh(h,E);a.add(u);var y=20,m=16007990,x=new THREE.ArrowHelper(p,l,y,m),f={direction:{i:p.x,j:p.y,k:p.z},position:{i:l.x,j:l.y,k:l.z}};a.add(x);var v=new dat.GUI({autoPlace:!1}),T=document.getElementById("my-gui-container");T.appendChild(v.domElement);var w=v.addFolder("Plane direction"),z=w.add(f.direction,"i",-1,1),g=w.add(f.direction,"j",-1,1),R=w.add(f.direction,"k",-1,1);w.open();var H=v.addFolder("Plane position"),O=H.add(f.position,"i",-61.5,61.5),b=H.add(f.position,"j",-22.5,22.5),M=H.add(f.position,"k",-33.5,33.5);H.open(),z.onChange(function(e){var t=new THREE.Vector3(e,f.direction.j,f.direction.k);t.normalize();var o=new THREE.Vector3(f.position.i,f.position.j,f.position.k);x.setDirection(t);var n=new d(r,s,c,o,t);u.geometry=n,u.geometry.verticesNeedUpdate=!0}),g.onChange(function(e){var t=new THREE.Vector3(f.direction.i,e,f.direction.k);t.normalize();var o=new THREE.Vector3(f.position.i,f.position.j,f.position.k);x.setDirection(t);var n=new d(r,s,c,o,t);u.geometry=n,u.geometry.verticesNeedUpdate=!0}),R.onChange(function(e){var t=new THREE.Vector3(f.direction.i,f.direction.j,e);t.normalize();var o=new THREE.Vector3(f.position.i,f.position.j,f.position.k);x.setDirection(t);var n=new d(r,s,c,o,t);u.geometry=n,u.geometry.verticesNeedUpdate=!0}),O.onChange(function(e){var t=new THREE.Vector3(f.direction.i,f.direction.j,f.direction.k);t.normalize();var o=new THREE.Vector3(e,f.position.j,f.position.k);a.remove(x),x=new THREE.ArrowHelper(t,o,y,m),a.add(x);var n=new d(r,s,c,o,t);u.geometry=n,u.geometry.verticesNeedUpdate=!0}),b.onChange(function(e){var t=new THREE.Vector3(f.direction.i,f.direction.j,f.direction.k);t.normalize();var o=new THREE.Vector3(f.position.i,e,f.position.k);a.remove(x),x=new THREE.ArrowHelper(t,o,y,m),a.add(x);var n=new d(r,s,c,o,t);u.geometry=n,u.geometry.verticesNeedUpdate=!0}),M.onChange(function(e){var t=new THREE.Vector3(f.direction.i,f.direction.j,f.direction.k);t.normalize();var o=new THREE.Vector3(f.position.i,f.position.j,e);a.remove(x),x=new THREE.ArrowHelper(t,o,y,m),a.add(x);var n=new d(r,s,c,o,t);u.geometry=n,u.geometry.verticesNeedUpdate=!0})}},{"../../modules/controls/OrbitControls2D":2,"../../modules/geometries/geometries.slice":4}],2:[function(e,t,o){THREE.OrbitControls2D=function(e,t){function o(){return 2*Math.PI/60/60*u.autoRotateSpeed}function n(){return Math.pow(.95,u.zoomSpeed)}function i(e){if(u.enabled!==!1){if(e.preventDefault(),e.button===u.mouseButtons.ORBIT){if(u.noRotate===!0)return;j=S.ROTATE,m.set(e.clientX,e.clientY)}else if(e.button===u.mouseButtons.ZOOM){if(u.noZoom===!0)return;j=S.DOLLY,R.set(e.clientX,e.clientY)}else if(e.button===u.mouseButtons.PAN){if(u.noPan===!0)return;j=S.PAN,v.set(e.clientX,e.clientY)}j!==S.NONE&&(document.addEventListener("mousemove",r,!1),document.addEventListener("mouseup",a,!1),u.dispatchEvent(k))}}function r(e){if(u.enabled!==!1){e.preventDefault();var t=u.domElement===document?u.domElement.body:u.domElement;if(j===S.ROTATE){if(u.noRotate===!0)return;x.set(e.clientX,e.clientY),f.subVectors(x,m),u.rotateLeft(2*Math.PI*f.x/t.clientWidth*u.rotateSpeed),u.rotateUp(2*Math.PI*f.y/t.clientHeight*u.rotateSpeed),m.copy(x)}else if(j===S.DOLLY){if(u.noZoom===!0)return;H.set(e.clientX,e.clientY),O.subVectors(H,R),O.y>0?u.dollyIn():u.dollyOut(),R.copy(H)}else if(j===S.PAN){if(u.noPan===!0)return;T.set(e.clientX,e.clientY),w.subVectors(T,v),u.pan(w.x,w.y),v.copy(T)}j!==S.NONE&&u.update()}}function a(){u.enabled!==!1&&(document.removeEventListener("mousemove",r,!1),document.removeEventListener("mouseup",a,!1),u.dispatchEvent(L),j=S.NONE)}function s(e){if(u.enabled!==!1&&u.noZoom!==!0&&j===S.NONE){e.preventDefault(),e.stopPropagation();var t=0;void 0!==e.wheelDelta?t=e.wheelDelta:void 0!==e.detail&&(t=-e.detail),t>0?u.dollyOut():u.dollyIn(),u.update(),u.dispatchEvent(k),u.dispatchEvent(L)}}function c(e){if(u.enabled!==!1&&u.noKeys!==!0&&u.noPan!==!0)switch(e.keyCode){case u.keys.UP:u.pan(0,u.keyPanSpeed),u.update();break;case u.keys.BOTTOM:u.pan(0,-u.keyPanSpeed),u.update();break;case u.keys.LEFT:u.pan(u.keyPanSpeed,0),u.update();break;case u.keys.RIGHT:u.pan(-u.keyPanSpeed,0),u.update()}}function d(e){if(u.enabled!==!1){switch(e.touches.length){case 1:if(u.noRotate===!0)return;j=S.TOUCH_ROTATE,m.set(e.touches[0].pageX,e.touches[0].pageY);break;case 2:if(u.noZoom===!0)return;j=S.TOUCH_DOLLY;var t=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+o*o);R.set(0,n);break;case 3:if(u.noPan===!0)return;j=S.TOUCH_PAN,v.set(e.touches[0].pageX,e.touches[0].pageY);break;default:j=S.NONE}j!==S.NONE&&u.dispatchEvent(k)}}function l(e){if(u.enabled!==!1){e.preventDefault(),e.stopPropagation();var t=u.domElement===document?u.domElement.body:u.domElement;switch(e.touches.length){case 1:if(u.noRotate===!0)return;if(j!==S.TOUCH_ROTATE)return;x.set(e.touches[0].pageX,e.touches[0].pageY),f.subVectors(x,m),u.rotateLeft(2*Math.PI*f.x/t.clientWidth*u.rotateSpeed),u.rotateUp(2*Math.PI*f.y/t.clientHeight*u.rotateSpeed),m.copy(x),u.update();break;case 2:if(u.noZoom===!0)return;if(j!==S.TOUCH_DOLLY)return;var o=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(o*o+n*n);H.set(0,i),O.subVectors(H,R),O.y>0?u.dollyOut():u.dollyIn(),R.copy(H),u.update();break;case 3:if(u.noPan===!0)return;if(j!==S.TOUCH_PAN)return;T.set(e.touches[0].pageX,e.touches[0].pageY),w.subVectors(T,v),u.pan(w.x,w.y),v.copy(T),u.update();break;default:j=S.NONE}}}function p(){u.enabled!==!1&&(u.dispatchEvent(L),j=S.NONE)}this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};var h,E,u=this,y=1e-6,m=new THREE.Vector2,x=new THREE.Vector2,f=new THREE.Vector2,v=new THREE.Vector2,T=new THREE.Vector2,w=new THREE.Vector2,z=new THREE.Vector3,g=new THREE.Vector3,R=new THREE.Vector2,H=new THREE.Vector2,O=new THREE.Vector2,b=0,M=0,P=1,V=new THREE.Vector3,D=new THREE.Vector3,B=new THREE.Quaternion,S={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},j=S.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone();var N=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),I=N.clone().inverse(),A={type:"change"},k={type:"start"},L={type:"end"};this.rotateLeft=function(e){void 0===e&&(e=o()),M-=e},this.rotateUp=function(e){void 0===e&&(e=o()),b-=e},this.panLeft=function(e){var t=this.object.matrix.elements;z.set(t[0],t[1],t[2]),z.multiplyScalar(-e),V.add(z)},this.panUp=function(e){var t=this.object.matrix.elements;z.set(t[4],t[5],t[6]),z.multiplyScalar(e),V.add(z)},this.pan=function(e,t){var o=u.domElement===document?u.domElement.body:u.domElement;if(void 0!==u.object.fov){var n=u.object.position,i=n.clone().sub(u.target),r=i.length();r*=Math.tan(u.object.fov/2*Math.PI/180),u.panLeft(2*e*r/o.clientHeight),u.panUp(2*t*r/o.clientHeight)}else void 0!==u.object.top?(u.panLeft(e*(u.object.right-u.object.left)/(o.clientWidth*this.object.zoom)),u.panUp(t*(u.object.top-u.object.bottom)/(o.clientHeight*this.object.zoom))):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(e){void 0===e&&(e=n()),void 0!==u.object.top?(this.object.zoom*=e,this.object.updateProjectionMatrix()):P/=e},this.dollyOut=function(e){void 0===e&&(e=n()),void 0!==u.object.top?(this.object.zoom/=e,this.object.updateProjectionMatrix()):P*=e},this.update=function(){var e=this.object.position;g.copy(e).sub(this.target),g.applyQuaternion(N),h=Math.atan2(g.x,g.z),E=Math.atan2(Math.sqrt(g.x*g.x+g.z*g.z),g.y),this.autoRotate&&j===S.NONE&&this.rotateLeft(o()),h+=M,E+=b,h=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,h)),E=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,E)),E=Math.max(y,Math.min(Math.PI-y,E));var t=g.length()*P;t=Math.max(this.minDistance,Math.min(this.maxDistance,t)),this.target.add(V),g.x=t*Math.sin(E)*Math.sin(h),g.y=t*Math.cos(E),g.z=t*Math.sin(E)*Math.cos(h),g.applyQuaternion(I),e.copy(this.target).add(g),this.object.lookAt(this.target),M=0,b=0,P=1,V.set(0,0,0),(D.distanceToSquared(this.object.position)>y||8*(1-B.dot(this.object.quaternion))>y)&&(this.dispatchEvent(A),D.copy(this.object.position),B.copy(this.object.quaternion))},this.reset=function(){j=S.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.update()},this.getPolarAngle=function(){return E},this.getAzimuthalAngle=function(){return h},this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},!1),this.domElement.addEventListener("mousedown",i,!1),this.domElement.addEventListener("mousewheel",s,!1),this.domElement.addEventListener("DOMMouseScroll",s,!1),this.domElement.addEventListener("touchstart",d,!1),this.domElement.addEventListener("touchend",p,!1),this.domElement.addEventListener("touchmove",l,!1),window.addEventListener("keydown",c,!1),this.update()},THREE.OrbitControls2D.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls2D.prototype.constructor=THREE.OrbitControls2D,t.exports=THREE.OrbitControls2D},{}],3:[function(e,t,o){var n=n||{};n.intersections=n.intersections||{},n.intersections.obbPlane=function(e,t){var o=[],n=t.direction.clone().applyMatrix4(e.toOBBSpace),i=new THREE.Vector3(0,0,0).applyMatrix4(e.toOBBSpace),r={position:t.position.clone().applyMatrix4(e.toOBBSpace),direction:new THREE.Vector3(n.x-i.x,n.y-i.y,n.z-i.z).normalize()},a=new THREE.Vector3(e.center.x-e.halfDimensions.x,e.center.y-e.halfDimensions.y,e.center.z-e.halfDimensions.z),s=new THREE.Vector3(e.center.x+e.halfDimensions.x,e.center.y+e.halfDimensions.y,e.center.z+e.halfDimensions.z),c={position:new THREE.Vector3(e.center.x-e.halfDimensions.x,e.center.y-e.halfDimensions.y,e.center.z-e.halfDimensions.z),direction:e.orientation.x},d=this.rayPlane(c,r);return d&&d.x>=a.x&&d.y>=a.y&&d.z>=a.z&&d.x<=s.x&&d.y<=s.y&&d.z<=s.z&&o.push(d.applyMatrix4(e.toOBBSpaceInvert)),c.direction=e.orientation.y,d=this.rayPlane(c,r),d&&d.x>=a.x&&d.y>=a.y&&d.z>=a.z&&d.x<=s.x&&d.y<=s.y&&d.z<=s.z&&o.push(d.applyMatrix4(e.toOBBSpaceInvert)),c.direction=e.orientation.z,d=this.rayPlane(c,r),d&&d.x>=a.x&&d.y>=a.y&&d.z>=a.z&&d.x<=s.x&&d.y<=s.y&&d.z<=s.z&&o.push(d.applyMatrix4(e.toOBBSpaceInvert)),c={position:new THREE.Vector3(e.center.x+e.halfDimensions.x,e.center.y+e.halfDimensions.y,e.center.z+e.halfDimensions.z),direction:e.orientation.x},d=this.rayPlane(c,r),d&&d.x>=a.x&&d.y>=a.y&&d.z>=a.z&&d.x<=s.x&&d.y<=s.y&&d.z<=s.z&&o.push(d.applyMatrix4(e.toOBBSpaceInvert)),c.direction=e.orientation.y,d=this.rayPlane(c,r),d&&d.x>=a.x&&d.y>=a.y&&d.z>=a.z&&d.x<=s.x&&d.y<=s.y&&d.z<=s.z&&o.push(d.applyMatrix4(e.toOBBSpaceInvert)),c.direction=e.orientation.z,d=this.rayPlane(c,r),d&&d.x>=a.x&&d.y>=a.y&&d.z>=a.z&&d.x<=s.x&&d.y<=s.y&&d.z<=s.z&&o.push(d.applyMatrix4(e.toOBBSpaceInvert)),c={position:new THREE.Vector3(e.center.x+e.halfDimensions.x,e.center.y-e.halfDimensions.y,e.center.z-e.halfDimensions.z),direction:e.orientation.y},d=this.rayPlane(c,r),d&&d.x>=a.x&&d.y>=a.y&&d.z>=a.z&&d.x<=s.x&&d.y<=s.y&&d.z<=s.z&&o.push(d.applyMatrix4(e.toOBBSpaceInvert)),c.direction=e.orientation.z,d=this.rayPlane(c,r),d&&d.x>=a.x&&d.y>=a.y&&d.z>=a.z&&d.x<=s.x&&d.y<=s.y&&d.z<=s.z&&o.push(d.applyMatrix4(e.toOBBSpaceInvert)),c={position:new THREE.Vector3(e.center.x-e.halfDimensions.x,e.center.y+e.halfDimensions.y,e.center.z-e.halfDimensions.z),direction:e.orientation.x},d=this.rayPlane(c,r),d&&d.x>=a.x&&d.y>=a.y&&d.z>=a.z&&d.x<=s.x&&d.y<=s.y&&d.z<=s.z&&o.push(d.applyMatrix4(e.toOBBSpaceInvert)),c.direction=e.orientation.z,d=this.rayPlane(c,r),d&&d.x>=a.x&&d.y>=a.y&&d.z>=a.z&&d.x<=s.x&&d.y<=s.y&&d.z<=s.z&&o.push(d.applyMatrix4(e.toOBBSpaceInvert)),c={position:new THREE.Vector3(e.center.x-e.halfDimensions.x,e.center.y-e.halfDimensions.y,e.center.z+e.halfDimensions.z),direction:e.orientation.x},d=this.rayPlane(c,r),d&&d.x>=a.x&&d.y>=a.y&&d.z>=a.z&&d.x<=s.x&&d.y<=s.y&&d.z<=s.z&&o.push(d.applyMatrix4(e.toOBBSpaceInvert)),c.direction=e.orientation.y,d=this.rayPlane(c,r),d&&d.x>=a.x&&d.y>=a.y&&d.z>=a.z&&d.x<=s.x&&d.y<=s.y&&d.z<=s.z&&o.push(d.applyMatrix4(e.toOBBSpaceInvert)),o},n.intersections.rayPlane=function(e,t){if(0!==e.direction.dot(t.direction)){var o=(t.direction.x*(t.position.x-e.position.x)+t.direction.y*(t.position.y-e.position.y)+t.direction.z*(t.position.z-e.position.z))/(t.direction.x*e.direction.x+t.direction.y*e.direction.y+t.direction.z*e.direction.z),n=new THREE.Vector3(e.position.x+o*e.direction.x,e.position.y+o*e.direction.y,e.position.z+o*e.direction.z);return n}return null},t.exports=n.intersections},{}],4:[function(e,t,o){var n=e("../core/Intersections"),i=i||{};i.geometries=i.geometries||{},i.geometries.slice=function(e,t,o,i,r){var a={halfDimensions:e,center:t,orientation:o,toOBBSpace:new THREE.Matrix4,toOBBSpaceInvert:new THREE.Matrix4},s={position:i,direction:r},c=n.obbPlane(a,s);c.length<3&&(window.console.log("WARNING: Less than 3 intersections between OBB and Plane."),window.console.log("OBB"),window.console.log(a),window.console.log("Plane"),window.console.log(s),window.console.log("exiting..."));for(var d=this.centerOfMass(c),l=this.orderIntersections(c,d,r),p=[],h=[],E=0;E<l.length;E++)p.push(l[E].point),h.push(l[E].xy);var u=new THREE.Shape;u.moveTo(h[0].x,h[0].y);for(var y=1;y<h.length;y++)u.lineTo(h[y].x,h[y].y);u.lineTo(h[0].x,h[0].y),THREE.ShapeGeometry.call(this,u),this.type="SliceGeometry",this.vertices=p,this.verticesNeedUpdate=!0},i.geometries.slice.prototype=Object.create(THREE.ShapeGeometry.prototype),i.geometries.slice.prototype.constructor=i.geometries.slice,i.geometries.slice.prototype.centerOfMass=function(e){for(var t=new THREE.Vector3(0,0,0),o=0;o<e.length;o++)t.x+=e[o].x,t.y+=e[o].y,t.z+=e[o].z;return t.divideScalar(e.length),t},i.geometries.slice.prototype.orderIntersections=function(e,t,o){for(var n=e[0].x,i=e[0].y,r=e[0].z,a=e[0].x-t.x,s=e[0].y-t.y,c=e[0].z-t.z,d={origin:new THREE.Vector3(n,i,r),direction:new THREE.Vector3(a,s,c).normalize()},l=new THREE.Vector3(0,0,0).crossVectors(d.direction,o).normalize(),p=[],h=0;h<e.length;h++){var E=e[h].x,u=e[h].y,y=e[h].z,m=e[h].x-t.x,x=e[h].y-t.y,f=e[h].z-t.z,v={origin:new THREE.Vector3(E,u,y),direction:new THREE.Vector3(m,x,f).normalize()},T=d.direction.dot(v.direction),w=l.dot(v.direction),z=Math.atan2(w,T),g=z*(180/Math.PI);p.push({angle:g,point:v.origin,xy:{x:T,y:w}})}return p.sort(function(e,t){return e.angle-t.angle}),p},t.exports=i.geometries.slice},{"../core/Intersections":3}]},{},[1]);
//# sourceMappingURL=../../examples/geometries_slice/geometries_slice.js.map