<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Source: modules/deprecated/slice/Slice.View.js</title>
    
    
    
    
    
    <meta property="og:title" content=""/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content=""/>
    
    <meta property="og:url" content=""/>
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jaguar.css">
    
    
    <script>
    var config = {"monospaceLinks":true,"cleverLinks":true,"default":{"outputSourceFiles":true},"applicationName":"VJS","disqus":"","googleAnalytics":"","openGraph":{"title":"","type":"website","image":"","site_name":"","url":""},"meta":{"title":"","description":"","keyword":""},"linenums":false};
    </script>
    

    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation">
    <h3 class="applicationName"><a href="index.html">VJS</a></h3>

    <div class="search">
        <input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations">
    </div>
    <ul class="list">
    
        <li class="item" data-name="VJS">
            <span class="title">
                <a href="VJS.html">VJS</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="VJS.frame">
            <span class="title">
                <a href="VJS.frame.html">VJS.frame</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="VJS.image">
            <span class="title">
                <a href="VJS.image.html">VJS.image</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="VJS.image.model"><a href="VJS.image.html#model">model</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="VJS.slice">
            <span class="title">
                <a href="VJS.slice.html">VJS.slice</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="VJS.slice.shader"><a href="VJS.slice.html#shader">shader</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="VJS.stack">
            <span class="title">
                <a href="VJS.stack.html">VJS.stack</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="VJS.stack.model"><a href="VJS.stack.html#model">model</a></li>
            
                <li data-name="VJS.stack.view"><a href="VJS.stack.html#view">view</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="VJS.volume">
            <span class="title">
                <a href="VJS.volume.html">VJS.volume</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="VJS.frame.model">
            <span class="title">
                <a href="VJS.frame.model.html">VJS.frame.model</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="VJS.frame.view">
            <span class="title">
                <a href="VJS.frame.view.html">VJS.frame.view</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="VJS.slice.core">
            <span class="title">
                <a href="VJS.slice.core.html">VJS.slice.core</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="VJS.slice.core#slice"><a href="VJS.slice.core.html#slice">slice</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="VJS.slice.view">
            <span class="title">
                <a href="VJS.slice.view.html">VJS.slice.view</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="VJS.slice.view#RASSlice"><a href="VJS.slice.view.html#RASSlice">RASSlice</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="VJS.volume.core">
            <span class="title">
                <a href="VJS.volume.core.html">VJS.volume.core</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="VJS.volume.core#computeConvenienceVars"><a href="VJS.volume.core.html#computeConvenienceVars">computeConvenienceVars</a></li>
            
                <li data-name="VJS.volume.core#createTexture"><a href="VJS.volume.core.html#createTexture">createTexture</a></li>
            
                <li data-name="VJS.volume.core#getValue"><a href="VJS.volume.core.html#getValue">getValue</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="VJS.volume.view">
            <span class="title">
                <a href="VJS.volume.view.html">VJS.volume.view</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
    </ul>
</div>
    <div class="main">
        <h1 class="page-title" data-filename="Slice.View.js.html">Source: modules/deprecated/slice/Slice.View.js</h1>
        


    
    <section>
        <article>
            <pre class="prettyprint source "><code>'use strict';

var VJS = VJS || {};
VJS.slice = VJS.slice || {};

/**
 * View class of slice component. Provides method to generate and interact all
 * slice related visualization.
 *
 * It includes the slice, the border of the slice, the slice normal, the
 * intersection between the slice, the slice center of mass, the data bouding
 * box, etc.
 *
 * Doesn't hold any slice-related generic logic.
 *
 * @constructor
 * @class
 *
 * @param {VJS.slice.core} sliceCore - Core slice instance.
 *
 */
VJS.slice.view = function(sliceCore) {
    this._sliceCore = sliceCore;
};

/**
 * Get a threeJS object that represents a slice.
 * It is fully configured and just have to be added to the renderer.
 * !!!! Make sure to call slice.core.slice() before. (should be hidden)
 * Object is displayed in RAS space. This should be an option somewhere...
 *
 * @return THREE.Object
 *
 */
VJS.slice.view.prototype.RASSlice = function() {
    //
    // create material from target Volume
    // setup uniforms
    var shaderSlice = VJS.slice.shader;
    var uniforms = shaderSlice.slice.uniforms;
    uniforms.uTextureSize.value = this._sliceCore._volumeCore._textureSize;
    var textures = this._sliceCore._volumeCore._textures;
    // 4 textures...
    uniforms.t00.value = textures[0];
    uniforms.t01.value = textures[1];
    uniforms.t02.value = textures[2];
    uniforms.t03.value = textures[3];
    uniforms.uIJKDims.value = this._sliceCore._volumeCore._ijk.dimensions;
    uniforms.uRASToIJK.value = this._sliceCore._volumeCore._transforms.ras2ijk;

    var mat = new THREE.ShaderMaterial({
        // 'wireframe': true,
        'side': THREE.DoubleSide,
        'transparency': true,
        'uniforms': uniforms,
        'vertexShader': shaderSlice.slice.vertexShader,
        'fragmentShader': shaderSlice.slice.fragmentShader,
    });

    // create geometry
    var vGeometry = this.sliceGeometry();
    // ... and mesh
    var plane = new THREE.Mesh(vGeometry, mat);

    // should it be separate...?
    // create the border!
    var material = new THREE.LineBasicMaterial({
        color: 0x0000ff
    });
    var geometry = new THREE.Geometry();
    for (var i = 0; i &lt; this._sliceCore._intersections.length; i++) {
        geometry.vertices.push(this._sliceCore._intersections[i]);
    }
    geometry.vertices.push(this._sliceCore._intersections);
    var line = new THREE.Line(geometry, material);


    var group = new THREE.Object3D();
    group.add(plane);
    group.add(line);

    return group;
};

VJS.slice.view.prototype.updateRASSlice = function(plane) {
    // Should get all information from there or from the Core...!
    plane.geometry = this.sliceGeometry();
};

VJS.slice.view.prototype.sliceGeometry = function() {

    var sliceGeom = null;

    var sliceShape = new THREE.Shape();
    // move to first point!
    sliceShape.moveTo(this._sliceCore._intersectionsXY[0].x, this._sliceCore._intersectionsXY[0].y);


    // loop through all points!
    for (var i = 1; i &lt; this._sliceCore._intersectionsXY.length; i++) {
        // project each on plane!
        sliceShape.lineTo(this._sliceCore._intersectionsXY[i].x, this._sliceCore._intersectionsXY[i].y);
    }

    // close the shape!
    sliceShape.lineTo(this._sliceCore._intersectionsXY[0].x, this._sliceCore._intersectionsXY[0].y);

    // Generate Geomotry. (all we care about is triangulation!)
    sliceGeom = new THREE.ShapeGeometry(sliceShape);

    // update real position of each vertex!
    sliceGeom.vertices = this._sliceCore._intersections;
    sliceGeom.verticesNeedUpdate = true;

    return sliceGeom;
};

// COM
// CORNERS
// BORDER?
</code></pre>
        </article>
    </section>






        

        <footer>
            Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.2</a> on Wed May 13 2015 09:02:24 GMT+0200 (CEST)
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
<script src="scripts/main.js"></script>
</body>
</html>
